\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{trflex}[2017/07/05 
  Flexible commands implementation for `tarantas' bundle]

\RequirePackage{trcore}

%% Fallback                                  
\DeclOpt*{
  \PackageError{trflex}{does not know about `\CurrentOption'.
  Please, clarify your intentions.}
}
\ProcOpts

\def \@trf@namespace{tarantas/flex/}
% {name} {default parameters} newcommand args /[2][]/ {
\def \trf@newcmd@prepare#1#2#3#{
  \esetStorePrefix{\@trf@namespace\ex@f\@gobble\detokenize{#1}}
  \storePairsDef{#2}
  \trf@newcmd@define{#1}{#3}
}
\def \trf@newcmd@define#1#2#3{
  \newcommand{#1}#2{
    \esetStorePrefix{\@trf@namespace\ex@f\@gobble\detokenize{#1}}
    #3
  }
}
\def \trf@newcmd@create{%
  \ifexpmode%
  {\unexpanded{\PackageError{trflex}{commands can't work in expansion-only mode}}}%
  {\trf@newcmd@prepare}%
}

\def \trf@var@use#1{
  \csuse{\@trkv@prefix#1}
}



\endinput
